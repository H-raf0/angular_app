<main>
  <h1 class="first-heading__title" i18n>My Todo List</h1>

  <div class="todo__stats">
    <p i18n>
      {{ getCompletedCount() }} of {{ getTotalCount() }} tasks completed
    </p>
  </div>

  <form class="todo-form__container" [formGroup]="newTodoForm" (ngSubmit)="addTodo()">
    <sl-input
      class="input--primary"
      placeholder="Add a new task..."
      i18n-placeholder
      appTrim
      required
      ngDefaultControl
      [formControl]="titleControl"
      (keydown.enter)="addTodo()"
    >
      <sl-icon name="plus-circle" slot="prefix" />
    </sl-input>
    <sl-button type="submit" variant="primary" [disabled]="newTodoForm.invalid">
      <sl-icon name="plus" slot="prefix" />
      <ng-container i18n>Add</ng-container>
    </sl-button>
  </form>

  @if (todos().length === 0) {
    <div class="todo-empty__container">
      <p i18n>No tasks yet. Add one above to get started!</p>
    </div>
  } @else {
    <ul class="todo-list__container">
      @for (todo of todos(); track todo.id) {
        <li class="todo-item" [class.completed]="todo.completed">
          <sl-checkbox
            [checked]="todo.completed"
            (sl-change)="toggleTodo(todo.id)"
          ></sl-checkbox>
          <input
            class="todo-item__title"
            [class.completed]="todo.completed"
            [value]="todo.title"
            (blur)="updateTodoTitle(todo.id, $any($event.target).value)"
            (keydown.enter)="$any($event.target).blur()"
          />
          <sl-button
            class="button--icon"
            variant="text"
            (click)="deleteTodo(todo.id)"
            i18n-label
            label="Delete task"
          >
            <sl-icon name="trash" />
          </sl-button>
        </li>
      }
    </ul>
  }
</main>

